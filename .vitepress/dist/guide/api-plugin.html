<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plugin API | Vite</title>
    <meta name="description" content="Frontend инструмент нового поколения">
    <link rel="stylesheet" href="/assets/style.07352472.css">
    <link rel="modulepreload" href="/assets/Home.c2f4e002.js">
    <link rel="modulepreload" href="/assets/ui-custom.4317acf0.js">
    <link rel="modulepreload" href="/assets/AlgoliaSearchBox.1f4ea44a.js">
    <link rel="modulepreload" href="/assets/app.877e1a61.js">
    <link rel="modulepreload" href="/assets/guide_api-plugin.md.e39a9fb1.lean.js">
    <link rel="modulepreload" href="/assets/app.877e1a61.js">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="twitter:title" content="Plugin API | Vite">
    <meta property="og:title" content="Plugin API | Vite">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-40587210><div class="sidebar-button" data-v-40587210><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Vite, back to home" data-v-40587210 data-v-7ac13a1e><img class="logo" src="/logo.svg" alt="Logo" data-v-7ac13a1e> Vite</a><div class="flex-grow" data-v-40587210></div><div class="nav" data-v-40587210><nav class="nav-links" data-v-40587210 data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item active" href="/guide/" data-v-49fe041d>Руководство <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/config/" data-v-49fe041d>Конфигурация <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/plugins/" data-v-49fe041d>Плагины <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>Ссылки</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://twitter.com/vite_js" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Twitter</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://chat.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Discord Chat</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/vitejs/awesome-vite" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Awesome Vite</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://dev.to/t/vite" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>DEV Community</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://vite-rollup-plugins.patak.dev/" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Rollup Plugins Compat</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/vitejs/vite/blob/main/packages/vite/CHANGELOG.md" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Changelog</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>Языки</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>English</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://cn.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>简体中文</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://ja.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>日本語</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><!----><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/vitejs/vite" target="_blank" rel="noopener noreferrer" data-v-49fe041d>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-17c48e2f><nav class="nav-links nav" data-v-17c48e2f data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item active" href="/guide/" data-v-49fe041d>Руководство <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/config/" data-v-49fe041d>Конфигурация <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/plugins/" data-v-49fe041d>Плагины <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>Ссылки</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://twitter.com/vite_js" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Twitter</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://chat.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Discord Chat</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/vitejs/awesome-vite" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Awesome Vite</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://dev.to/t/vite" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>DEV Community</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://vite-rollup-plugins.patak.dev/" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Rollup Plugins Compat</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/vitejs/vite/blob/main/packages/vite/CHANGELOG.md" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Changelog</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>Языки</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>English</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://cn.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>简体中文</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://ja.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>日本語</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><!----><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/vitejs/vite" target="_blank" rel="noopener noreferrer" data-v-49fe041d>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-17c48e2f><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Руководство</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/why">Почему Vite</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/">Начало работы</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/features">Функционал</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/using-plugins">Использование плагинов</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/dep-pre-bundling">Pre-Bundling зависимостей</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/assets">Обработка статичных ресурсов</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/build">Сборка для Production</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/static-deploy">Деплой статичного сайта</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/env-and-mode">Env переменные и Modes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/ssr">Server-Side Rendering (SSR)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/backend-integration">Backend интеграция</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/comparisons">Сравнение</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/migration">Миграция с v1</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">APIs</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/guide/api-plugin">Plugin API</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#согnашения">Соглашения</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#plugins-config">Plugins config</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#простые-примеры">Простые примеры</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#importing-a-virtual-file">Importing a Virtual File</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#трансформирование-custom-file-types">Трансформирование Custom File Types</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#universal-hooks">Universal Hooks</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#vite-specific-hooks">Vite Specific Hooks</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#config">config</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#configresolved">configResolved</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#configureserver">configureServer</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#transformindexhtml">transformIndexHtml</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#handlehotupdate">handleHotUpdate</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#порядок-применения-пnагинов">Порядок применения плагинов</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#усnовное-применение">Условное применение</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#совместимость-с-rollup-пnагинами">Совместимость с Rollup плагинами</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#нормаnизация-путей">Нормализация путей</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/api-hmr">HMR API</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/guide/api-javascript">JavaScript API</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/config/">Config Reference</a><!----></li></ul></li><!--]--></ul><!--[--><!--[--><div class="sponsors"><a href="https://github.com/sponsors/yyx990803" target="_blank" rel="noopener"><span>Спонсоры</span></a><a href="https://tailwindcss.com" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/tailwind-labs.svg" alt="Tailwind Labs" id="sponsor-tailwind"></a><a href="https://vuejobs.com/?ref=vuejs" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/vuejobs.png" alt="Vue Jobs" id="sponsor-vuejobs"></a><a href="https://mux.com" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/mux.svg" alt="Mux" id="sponsor-mux"></a><a href="https://plaid.co.jp/" target="_blank" rel="noopener" aria-label="sponsor-img"><img src="/plaid.svg" alt="Plaid Inc." id="sponsor-plaid"></a></div><!--]--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-8fcebc32><div class="container" data-v-8fcebc32><!--[--><!--[--><div id="ads-container"><div class="carbon-ads" data-v-71eb9365></div></div><!--]--><!--[--><!--]--><!--]--><div style="position:relative;" class="content" data-v-8fcebc32><div><h1 id="plugin-api" tabindex="-1">Plugin API <a class="header-anchor" href="#plugin-api" aria-hidden="true">#</a></h1><p>Vite плагины расширяют хорошо спроектированный интерфейс плагинов Rollup с некоторыми дополнительными Vite-specific опциями. Поэтому, вы можете один раз написать Vite плагин и он будет работать и в dev и в build.</p><p><strong>Рекомендуется сначала прочитать <a href="https://rollupjs.org/guide/en/#plugin-development" target="_blank" rel="noopener noreferrer">Rollup&#39;s plugin documentation</a> прежде чем продолжать чтение этой секции.</strong></p><h2 id="согnашения" tabindex="-1">Соглашения <a class="header-anchor" href="#согnашения" aria-hidden="true">#</a></h2><p>Если плагин не использует Vite specific hooks и может быть реализован как <a href="#rollup-plugin-compatibility">Compatible Rollup Plugin</a>, то мы рекомендуем использовать <a href="https://rollupjs.org/guide/en/#conventions" target="_blank" rel="noopener noreferrer">Rollup Plugin naming conventions</a></p><ul><li>Rollup плагины должны иметь понятное имя с префиксом <code>rollup-plugin-</code>.</li><li>Включать <code>rollup-plugin</code> и <code>vite-plugin</code> ключевые слова в package.json.</li></ul><p>Это также позволяет использовать плагин в чистом Rollup или WMR based проектах</p><p>Для плагинов только для Vite</p><ul><li>Vite плагины должны иметь понятное имя с префиксом <code>vite-plugin-</code>.</li><li>Включать <code>vite-plugin</code> ключевое слово в package.json.</li><li>Иметь раздел документации плагина, детально описывающий почему этот плагин только для Vite (например, плагин использует Vite specific plugin hooks).</li></ul><p>Если ваш плагин будет работать только с конкретным фреймворком, то название плагина должно включать в себя часть с префиксом этого фреймворка</p><ul><li><code>vite-plugin-vue-</code> префикс для Vue плагинов</li><li><code>vite-plugin-react-</code> префикс для React плагинов</li><li><code>vite-plugin-svelte-</code> префикс для Svelte плагинов</li></ul><h2 id="plugins-config" tabindex="-1">Plugins config <a class="header-anchor" href="#plugins-config" aria-hidden="true">#</a></h2><p>Пользователи будут добавлять плагины в<code>devDependencies</code> проекта и настраивать их используя <code>plugins</code> array option.</p><div class="language-js"><pre><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> vitePlugin <span class="token keyword">from</span> <span class="token string">&#39;vite-plugin-feature&#39;</span>
<span class="token keyword">import</span> rollupPlugin <span class="token keyword">from</span> <span class="token string">&#39;rollup-plugin-feature&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vitePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rollupPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Falsy плагины будут игнорированы, что может быть использовано для лёгкой активации и деактивации плагинов.</p><p><code>plugins</code> также принимает preset&#39;ы включающие несколько плагинов как один элемент. Это полезно для сложных фич (таких, как интеграция фреймворков), которая реализуется используя несколько плагинов. Массив будет внутренне &quot;flattened&quot; выровнен (элементы на одном уровне, без вложенности).</p><div class="language-js"><pre><code><span class="token comment">// framework-plugin</span>
<span class="token keyword">import</span> frameworkRefresh <span class="token keyword">from</span> <span class="token string">&#39;vite-plugin-framework-refresh&#39;</span>
<span class="token keyword">import</span> frameworkDevtools <span class="token keyword">from</span> <span class="token string">&#39;vite-plugin-framework-devtools&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">framework</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">frameworkRefresh</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">frameworkDevTools</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js"><pre><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite&#39;</span>
<span class="token keyword">import</span> framework <span class="token keyword">from</span> <span class="token string">&#39;vite-plugin-framework&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">framework</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="простые-примеры" tabindex="-1">Простые примеры <a class="header-anchor" href="#простые-примеры" aria-hidden="true">#</a></h2><div class="tip custom-block"><p class="custom-block-title">Подсказка</p><p>Общепринятым является создание Vite/Rollup плагина как factory function &quot;функция фабрика&quot;, которая возвращает актуальный объект плагина. Функция может принимать параметры, которые позволяют пользователям кастомизировать поведение плагина.</p></div><h3 id="importing-a-virtual-file" tabindex="-1">Importing a Virtual File <a class="header-anchor" href="#importing-a-virtual-file" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">myPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> virtualFileId <span class="token operator">=</span> <span class="token string">&#39;@my-virtual-file&#39;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;my-plugin&#39;</span><span class="token punctuation">,</span> <span class="token comment">// обязательно, будет показано при warnings и errors</span>
    <span class="token function">resolveId</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">===</span> virtualFileId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> virtualFileId
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">===</span> virtualFileId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">export const msg = &quot;from virtual file&quot;</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Это позволяет нам импортировать файл в JavaScript:</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> msg <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@my-virtual-file&#39;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
</code></pre></div><h3 id="трансформирование-custom-file-types" tabindex="-1">Трансформирование Custom File Types <a class="header-anchor" href="#трансформирование-custom-file-types" aria-hidden="true">#</a></h3><div class="language-js"><pre><code><span class="token keyword">const</span> fileRegex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(my-file-ext)$</span><span class="token regex-delimiter">/</span></span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">myPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;transform-file&#39;</span><span class="token punctuation">,</span>

    <span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>fileRegex<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          code<span class="token operator">:</span> <span class="token function">compileFileToJS</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span>
          map<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// provide source map if available</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="universal-hooks" tabindex="-1">Universal Hooks <a class="header-anchor" href="#universal-hooks" aria-hidden="true">#</a></h2><p>В процессе разработки, Vite dtv сервер создаёт плагин контейнер, который вызывает <a href="https://rollupjs.org/guide/en/#build-hooks" target="_blank" rel="noopener noreferrer">Rollup Build Hooks</a> Rollup делает это тем же способом.</p><p>Следующие hooks (хуки) вызываются один раз при запуске сервера:</p><ul><li><a href="https://rollupjs.org/guide/en/#options" target="_blank" rel="noopener noreferrer"><code>options</code></a></li><li><a href="https://rollupjs.org/guide/en/#buildstart" target="_blank" rel="noopener noreferrer"><code>buildStart</code></a></li></ul><p>Следующие hooks (хуки) вызываются при каждом входящем запросе модуля:</p><ul><li><a href="https://rollupjs.org/guide/en/#resolveid" target="_blank" rel="noopener noreferrer"><code>resolveId</code></a></li><li><a href="https://rollupjs.org/guide/en/#load" target="_blank" rel="noopener noreferrer"><code>load</code></a></li><li><a href="https://rollupjs.org/guide/en/#transform" target="_blank" rel="noopener noreferrer"><code>transform</code></a></li></ul><p>Следующие hooks (хуки) вызываются когда сервер потушен:</p><ul><li><a href="https://rollupjs.org/guide/en/#buildend" target="_blank" rel="noopener noreferrer"><code>buildEnd</code></a></li><li><a href="https://rollupjs.org/guide/en/#closebundle" target="_blank" rel="noopener noreferrer"><code>closeBundle</code></a></li></ul><p>Обратите внимание, что <a href="https://rollupjs.org/guide/en/#moduleparsed" target="_blank" rel="noopener noreferrer"><code>moduleParsed</code></a> hook <strong>НЕ</strong> вызывается во время dev, потому что Vite избегает полного парсинга AST для улучшения производительности.</p><p><a href="https://rollupjs.org/guide/en/#output-generation-hooks" target="_blank" rel="noopener noreferrer">Output Generation Hooks</a> (кроме <code>closeBundle</code>) <strong>НЕ</strong> вызываются во время dev. Вы можете думать, что Vite&#39;s dev сервер вызывает только <code>rollup.rollup()</code> без вызова <code>bundle.generate()</code>.</p><h2 id="vite-specific-hooks" tabindex="-1">Vite Specific Hooks <a class="header-anchor" href="#vite-specific-hooks" aria-hidden="true">#</a></h2><p>Vite плагины также могу предоставлять хуки, которые служат Vite-specific целям. Rollup игнорирует эти хуки.</p><h3 id="config" tabindex="-1"><code>config</code> <a class="header-anchor" href="#config" aria-hidden="true">#</a></h3><ul><li><p><strong>Type:</strong> <code>(config: UserConfig, env: { mode: string, command: string }) =&gt; UserConfig | null | void</code></p></li><li><p><strong>Kind:</strong> <code>async</code>, <code>sequential</code></p><p>Изменяет конфигурацию Vite, прежде чем она будет резолвнута. Хук получает необработанный config (CLI option смёрдженные с конфиг файлом) и текущую конфигурацию env, которая exposes используемые <code>mode</code> и <code>command</code>. Можете вернуть частичный объект конфига, который будет глубоко смёрджен (deeply merged) с существующей конфигурацией или напрямую изменить congif (если дефолтный merging не может достичь желаемого результата).</p><p><strong>Пример:</strong></p><div class="language-js"><pre><code><span class="token comment">// вернуть частичный конфиг (рекомендуется)</span>
<span class="token keyword">const</span> <span class="token function-variable function">partialConfigPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;return-partial&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">config</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      foo<span class="token operator">:</span> <span class="token string">&#39;bar&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// напрямую изменить конфиг (используйте только когда merging не работает)</span>
<span class="token keyword">const</span> <span class="token function-variable function">mutateConfigPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;mutate-config&#39;</span><span class="token punctuation">,</span>
  <span class="token function">config</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> <span class="token punctuation">{</span> command <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>command <span class="token operator">===</span> <span class="token string">&#39;build&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span>root <span class="token operator">=</span> __dirname
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">Заметка</p><p>Плагины пользователей резолвятся до запуска этого хука, поэтому встраивание (injecting) других плагинов внутри <code>config</code> хука не приведёт ни к каким результатам.</p></div></li></ul><h3 id="configresolved" tabindex="-1"><code>configResolved</code> <a class="header-anchor" href="#configresolved" aria-hidden="true">#</a></h3><ul><li><p><strong>Type:</strong> <code>(config: ResolvedConfig) =&gt; void | Promise&lt;void&gt;</code></p></li><li><p><strong>Kind:</strong> <code>async</code>, <code>parallel</code></p><p>Вызывается после того, как Vite config резолвнется. Используйте этот хук, чтобы прочитать и сохранить финальный резолвнутый конфиг. Это также полезно, когда плагину нужно сделать что-нибудь другое в зависимости от выполняемой команды.</p><p><strong>Пример:</strong></p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">examplePlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> config

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;read-config&#39;</span><span class="token punctuation">,</span>

    <span class="token function">configResolved</span><span class="token punctuation">(</span><span class="token parameter">resolvedConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// сохранить резолвнутый (resolved) config</span>
      config <span class="token operator">=</span> resolvedConfig
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// потом можно использовать сохранённый store в других хуках</span>
    <span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>command <span class="token operator">===</span> <span class="token string">&#39;serve&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// serve: plugin invoked by dev server</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// build: plugin invoked by Rollup</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul><h3 id="configureserver" tabindex="-1"><code>configureServer</code> <a class="header-anchor" href="#configureserver" aria-hidden="true">#</a></h3><ul><li><p><strong>Type:</strong> <code>(server: ViteDevServer) =&gt; (() =&gt; void) | void | Promise&lt;(() =&gt; void) | void&gt;</code></p></li><li><p><strong>Kind:</strong> <code>async</code>, <code>sequential</code></p></li><li><p><strong>Читайте также:</strong> <a href="./api-javascript.html#vitedevserver">ViteDevServer</a></p><p>Хук для настройки (конфигурирования) dev сервера. Самый популярный случай использования - это добавление кастомноых middlewares во внутренний <a href="https://github.com/senchalabs/connect" target="_blank" rel="noopener noreferrer">connect</a> app:</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">myPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;configure-server&#39;</span><span class="token punctuation">,</span>
  <span class="token function">configureServer</span><span class="token punctuation">(</span><span class="token parameter">server</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    server<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// custom handle request...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Injecting Post Middleware</strong></p><p><code>configureServer</code> хук вызывается до того, как внутренние middlewares установлены, поэтому кастомные middlewares будут запущены до internal middlewares по умолчанию. Если вы хотите заинжектить middleware <strong>после</strong> internal middlewares, вы можете вернуть функцию из <code>configureServer</code>, которая будет вызвана после того, как internal middlewares будут установлены:</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">myPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;configure-server&#39;</span><span class="token punctuation">,</span>
  <span class="token function">configureServer</span><span class="token punctuation">(</span><span class="token parameter">server</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// возвращаем post hook, который вызовется после того, как</span>
    <span class="token comment">// internal middlewares будут установлены</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      server<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// custom handle request...</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Storing Server Access</strong></p><p>В некоторых случаях, другим хукам плагина могут понадобиться доступы до экземпляра dev сервера (например, доступ до web socket server, the file system watcher, или the module graph). Этот хук может быть использован для сохранения экземпляра сервера, чтобы потом обращаться к этому экземпляру из других хуков:</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">myPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> server
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;configure-server&#39;</span><span class="token punctuation">,</span>
    <span class="token function">configureServer</span><span class="token punctuation">(</span><span class="token parameter">_server</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      server <span class="token operator">=</span> _server
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// use server...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Заметьте, <code>configureServer</code> не вызывается когда запущен production build, поэтому другим вашим хукам необходимо подготовиться к этому, к отсутствию этого хука.</p></li></ul><h3 id="transformindexhtml" tabindex="-1"><code>transformIndexHtml</code> <a class="header-anchor" href="#transformindexhtml" aria-hidden="true">#</a></h3><ul><li><p><strong>Type:</strong> <code>IndexHtmlTransformHook | { enforce?: &#39;pre&#39; | &#39;post&#39; transform: IndexHtmlTransformHook }</code></p></li><li><p><strong>Kind:</strong> <code>async</code>, <code>sequential</code></p><p>Выделенный хук для трансформирования <code>index.html</code>. Этот хук получает текущую HTML строку и transform context. Context предоставляет <a href="./api-javascript.html#vitedevserver"><code>ViteDevServer</code></a> экземпляр во время dev (разработки) и output Rollup bundle для build.</p><p>Этот хук может быть асинхронным и может возвращать одно из следующих значений:</p><ul><li>Трансформированную HTML строку</li><li>Array of tag descriptor objects (<code>{ tag, attrs, children }</code>) , чтобы встроить их в существующий HTML. Каждый тег также может указать куда ему следует инжектиться (по умолчанию добавляется в <code>&lt;head&gt;</code>)</li><li>Объект содержащий <code>{ html, tags }</code></li></ul><p><strong>Базовый пример:</strong></p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">htmlPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;html-transform&#39;</span><span class="token punctuation">,</span>
    <span class="token function">transformIndexHtml</span><span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> html<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>
        <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;title&gt;(.*?)&lt;\/title&gt;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;title&gt;Title replaced!&lt;/title&gt;</span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Full Hook Signature (полная сигнатура хука):</strong></p><div class="language-ts"><pre><code><span class="token keyword">type</span> <span class="token class-name">IndexHtmlTransformHook</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  html<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  ctx<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token builtin">string</span>
    filename<span class="token operator">:</span> <span class="token builtin">string</span>
    server<span class="token operator">?</span><span class="token operator">:</span> ViteDevServer
    bundle<span class="token operator">?</span><span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;rollup&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>OutputBundle
    chunk<span class="token operator">?</span><span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;rollup&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>OutputChunk
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token operator">|</span> IndexHtmlTransformResult
  <span class="token operator">|</span> <span class="token keyword">void</span>
  <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>IndexHtmlTransformResult <span class="token operator">|</span> <span class="token keyword">void</span><span class="token operator">&gt;</span>

<span class="token keyword">type</span> <span class="token class-name">IndexHtmlTransformResult</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token builtin">string</span>
  <span class="token operator">|</span> HtmlTagDescriptor<span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span>
      html<span class="token operator">:</span> <span class="token builtin">string</span>
      tags<span class="token operator">:</span> HtmlTagDescriptor<span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">HtmlTagDescriptor</span> <span class="token punctuation">{</span>
  tag<span class="token operator">:</span> <span class="token builtin">string</span>
  attrs<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token operator">&gt;</span>
  children<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> HtmlTagDescriptor<span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token comment">/**
   * default: &#39;head-prepend&#39;
   */</span>
  injectTo<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;head&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;body&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;head-prepend&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;body-prepend&#39;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul><h3 id="handlehotupdate" tabindex="-1"><code>handleHotUpdate</code> <a class="header-anchor" href="#handlehotupdate" aria-hidden="true">#</a></h3><ul><li><p><strong>Type:</strong> <code>(ctx: HmrContext) =&gt; Array&lt;ModuleNode&gt; | void | Promise&lt;Array&lt;ModuleNode&gt; | void&gt;</code></p><p>Выполняет кастомную обработку HMR обновлений. Этот хук получает context object со следующей сигнатурой:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">HmrContext</span> <span class="token punctuation">{</span>
  file<span class="token operator">:</span> <span class="token builtin">string</span>
  timestamp<span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token keyword">module</span>s<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ModuleNode<span class="token operator">&gt;</span>
  <span class="token function-variable function">read</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>
  server<span class="token operator">:</span> ViteDevServer
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p><code>modules</code> массив модулей, которые затронуты изменениями в файле. Это массив, потому что одиночный файл может мапиться с несколькими модулями, обрабатываемыми сервером (например, Vue SFCs).</p></li><li><p><code>read</code> это асинхронная функция чтения, которая возвращает content файла. Это предоставляется потому что на некоторых системах, callback от изменений файла может происходить даже быстрее, чем пользователь успеет изменить файл и прямой метод <code>fs.readFile</code> вернёт пустой контент. Функция чтения нормализует это поведение.</p></li></ul><p>Хук можно использовать для:</p><ul><li><p>Фильтрации и отсечения ненужного списка затронутых модулей, чтобы HMR работал более точнее.</p></li><li><p>Возвращения пустого массива и выполнения полной пользовательской обработки HMR, отправив пользователю custom events:</p><div class="language-js"><pre><code><span class="token function">handleHotUpdate</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> server <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  server<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">&#39;custom&#39;</span><span class="token punctuation">,</span>
    event<span class="token operator">:</span> <span class="token string">&#39;special-update&#39;</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Клиентский код должен зарегистрировать соответствующий обработчик используя <a href="./api-hmr.html">HMR API</a> (это может быть встроено с помощью хука <code>transform</code> этого же плагина):</p><div class="language-js"><pre><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;special-update&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// perform custom update</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul><h2 id="порядок-применения-пnагинов" tabindex="-1">Порядок применения плагинов <a class="header-anchor" href="#порядок-применения-пnагинов" aria-hidden="true">#</a></h2><p>Vite плагин может дополнительно указать свойство <code>enforce</code> (похоже на webpack loaders) чтобы настроить порядок применения плагинов. Значение поля <code>enforce</code> может быть <code>&quot;pre&quot;</code> или <code>&quot;post&quot;</code>. Резолвнутые плагины будут идти в следующем порядке:</p><ul><li>Alias</li><li>Пользовательские плагины с <code>enforce: &#39;pre&#39;</code></li><li>Vite core плагины</li><li>Пользовательские плагины без значения enforce</li><li>Vite build плагины</li><li>Пользовательские плагины с <code>enforce: &#39;post&#39;</code></li><li>Vite post build плагины (minify, manifest, reporting)</li></ul><h2 id="усnовное-применение" tabindex="-1">Условное применение <a class="header-anchor" href="#усnовное-применение" aria-hidden="true">#</a></h2><p>По умолчанию плагины выполняются и для serve и для build. В случае, где плагин нужно применить только на serve или build, используйте свойство <code>apply</code>, чтобы запустить плагин только на <code>&#39;build&#39;</code> или <code>&#39;serve&#39;</code>:</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">myPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;build-only&#39;</span><span class="token punctuation">,</span>
    apply<span class="token operator">:</span> <span class="token string">&#39;build&#39;</span> <span class="token comment">// or &#39;serve&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Также для большего контроля можно использовать какую-нибудь функцию:</p><div class="language-js"><pre><code><span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> <span class="token punctuation">{</span> command <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// apply only on build but not for SSR</span>
  <span class="token keyword">return</span> command <span class="token operator">===</span> <span class="token string">&#39;build&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>config<span class="token punctuation">.</span>build<span class="token punctuation">.</span>ssr
<span class="token punctuation">}</span>
</code></pre></div><h2 id="совместимость-с-rollup-пnагинами" tabindex="-1">Совместимость с Rollup плагинами <a class="header-anchor" href="#совместимость-с-rollup-пnагинами" aria-hidden="true">#</a></h2><p>Изрядное количество подключаемых Rollup плагинов будут работать прямо как Vite плагины (например <code>@rollup/plugin-alias</code> или <code>@rollup/plugin-json</code>), но не все плагины работают так, поскольку некоторые хуки плагинов не имеют смысла в (несобранном) unbundled dev сервер контексте.</p><p>В общем, если плагин Rollup соответствует следующим критериям, то он должен работать как простой Vite плагин:</p><ul><li>Он не использует <a href="https://rollupjs.org/guide/en/#moduleparsed" target="_blank" rel="noopener noreferrer"><code>moduleParsed</code></a> хук.</li><li>Он не имеет жёсткой связи с bundle-phase хуками и output-phase хуками.</li></ul><p>Если Rollup плагин может быть применим только на build phase, то лучше указать его в <code>build.rollupOptions.plugins</code>.</p><p>Вы также можете дополнить существующий Rollup плагин Vite-only свойствами:</p><div class="language-js"><pre><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> example <span class="token keyword">from</span> <span class="token string">&#39;rollup-plugin-example&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      enforce<span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>
      apply<span class="token operator">:</span> <span class="token string">&#39;build&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Ознакомьтесь с <a href="https://vite-rollup-plugins.patak.dev" target="_blank" rel="noopener noreferrer">Vite Rollup Plugins</a> - список официальных совместимых Rollup плагинов с пользовательскими инструкциями.</p><h2 id="нормаnизация-путей" tabindex="-1">Нормализация путей <a class="header-anchor" href="#нормаnизация-путей" aria-hidden="true">#</a></h2><p>Vite нормализует пути при резолве id, чтобы использовать POSIX разделители ( / ) при сохранении volume в Windows. С другой стороны, Rollup оставляет нетронутыми пути по умолчанию, поэтому резолвнутые id имеют win32 разделители ( \ ) в Windows. Однако, Rollup плагины используют <a href="https://github.com/rollup/plugins/tree/master/packages/pluginutils#normalizepath" target="_blank" rel="noopener noreferrer"><code>normalizePath</code> utility function</a> из <code>@rollup/pluginutils</code> внутренне, который преобразует разделители в POSIX до выполнения сравнения. Это значит, что когда эти плагины используются в Vite, <code>include</code> и <code>exclude</code> config pattern и другие аналогичные пути для сравнения резолвнутых id работают правильно.</p><p>Итак, для Vite плагинов, при сравнении резолвнутых путей id важно сначала нормализовать пути для использования POSIX разделителей. Эквивалентная утилитарная функция <code>normalizePath</code> экспортируется из модуля <code>vite</code>.</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> normalizePath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite&#39;</span>

<span class="token function">normalizePath</span><span class="token punctuation">(</span><span class="token string">&#39;foo\\bar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &#39;foo/bar&#39;</span>
<span class="token function">normalizePath</span><span class="token punctuation">(</span><span class="token string">&#39;foo/bar&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &#39;foo/bar&#39;</span>
</code></pre></div></div></div><footer class="page-footer" data-v-8fcebc32 data-v-5c96fb00><div class="edit" data-v-5c96fb00><div class="edit-link" data-v-5c96fb00 data-v-55695e90><a class="link" href="https://github.com/vitejs/vite/edit/main/docs/guide/api-plugin.md" target="_blank" rel="noopener noreferrer" data-v-55695e90>Предложить правки для этой страницы <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-55695e90><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-5c96fb00><!----></div></footer><div class="next-and-prev-link" data-v-8fcebc32 data-v-e65a9748><div class="container" data-v-e65a9748><div class="prev" data-v-e65a9748><a class="link" href="/guide/migration" data-v-e65a9748><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-e65a9748><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-e65a9748>Миграция с v1</span></a></div><div class="next" data-v-e65a9748><a class="link" href="/guide/api-hmr" data-v-e65a9748><span class="text" data-v-e65a9748>HMR API</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-e65a9748><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"blog_announcing-vite2.md\":\"f9ffb3b5\",\"config_index.md\":\"79240e6d\",\"guide_api-hmr.md\":\"3ad542bd\",\"guide_api-javascript.md\":\"587c640f\",\"guide_api-plugin.md\":\"e39a9fb1\",\"guide_assets.md\":\"957bc666\",\"guide_backend-integration.md\":\"86f1c7d2\",\"guide_build.md\":\"ce7eef91\",\"guide_comparisons.md\":\"7b924354\",\"guide_dep-pre-bundling.md\":\"5097dacb\",\"guide_env-and-mode.md\":\"fceda997\",\"guide_features.md\":\"78cb284a\",\"guide_index.md\":\"5ada37b9\",\"guide_migration.md\":\"ab047701\",\"guide_ssr.md\":\"e209347a\",\"guide_static-deploy.md\":\"718ce6f8\",\"guide_using-plugins.md\":\"c505b5f7\",\"guide_why.md\":\"1d844fe6\",\"index.md\":\"9042ebe7\",\"plugins_index.md\":\"cf195799\"}")</script>
    <script type="module" async src="/assets/app.877e1a61.js"></script>
    
  </body>
</html>